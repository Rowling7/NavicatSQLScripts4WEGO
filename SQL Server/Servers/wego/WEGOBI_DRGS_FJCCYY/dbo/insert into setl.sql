--插入setlinfo表
INSERT INTO [dbo].[t_setlinfo] (
	acct_payamt
,	acp_medins_name
,	acp_optins_code
,	act_ipt_days
,	adm_caty
,	adm_dept_codg
,	adm_dept_name
,	adm_time
,	adm_way
,	age
,	bill_code
,	bill_no
,	biz_sn
,	bld_amt
,	bld_cat
,	bld_unt
,	brdy
,	brjsrq
,	brjsrq_dateofmonth
,	certno
,	check_fee
,	chfpdr_code
,	chfpdr_code_std
,	chfpdr_name
,	chinese_drug_fee
,	chinese_slice_drug_fee
,	coner_addr
,	coner_name
,	coner_tel
,	consumable_fee
,	createtime
,	curr_addr
,	curr_addr_cotycode
,	curr_addr_provcode
,	curr_addr_rdgncode
,	cyksbm
,	cyksbm_area
,	cyksmc
,	days_rinp_flag_31
,	days_rinp_pup_31
,	dcla_time
,	diag_code_cnt
,	drug_fee
,	dscg_caty
,	dscg_dept_codg
,	dscg_dept_name
,	dscg_time
,	dscg_way
,	emp_addr
,	emp_name
,	emp_tel
,	fixmedins_code
,	fixmedins_name
,	gend
,	hi_no
,	hi_paymtd
,	hi_setl_lv
,	hi_type
,	hsorg
,	hsorg_code
,	hsorg_opter
,	hsorg_opter_code
,	insuplc
,	ipt_med_type
,	is_rjbf
,	isdrg
,	lv1_nurscare_days
,	lv3_nurscare_days
,	main_diag_code
,	main_diag_name
,	main_oper_dr_name
,	main_oper_oprn_code
,	main_oper_oprn_name
,	mdtrt_id
,	medcasno
,	medical_fee
,	medical_group
,	medical_zz_time
,	medicalinsurancecoder
,	medicalinsurancecodetime
,	medicalrecordcoder
,	medicalrecordcodetime
,	medins_fill_dept
,	medins_fill_psn
,	mul_nwb_adm_wt
,	mul_nwb_bir_wt
,	naty
,	ntly
,	nwb_adm_type
,	nwb_adm_wt
,	nwb_age
,	nwb_bir_wt
,	oprn_oprt_code_cnt
,	opsp_diag_caty
,	opsp_mdtrt_date
,	other_diag_code1
,	other_diag_name1
,	otp_tcm_dise
,	otp_wm_dise
,	patn_cert_type
,	patn_rlts
,	payloc
,	poscode
,	prfs
,	psn_cashpay
,	psn_name
,	psn_no
,	psn_ownpay_fee
,	psn_selfpay_amt
,	pwcry_afadm_coma_dura
,	pwcry_bfadm_coma_dura
,	refldept_dept
,	refldept_dept1
,	refldept_dept2
,	refldept_dept3
,	refldept_dept4
,	refldept_dept5
,	resp_nurs_code
,	resp_nurs_code_std
,	resp_nurs_name
,	ryksbm
,	ryksmc
,	scd_nurscare_days
,	setl_begn_date
,	setl_end_date
,	setl_id
,	setl_list_id
,	sp_psn_type
,	spga_nurscare_days
,	stas_type
,	tcm_dise_code
,	total_fee
,	trt_type
,	vent_used_dura
,	west_drug_fee
,	wm_dise_code
,	mdtrt_sn
)
SELECT 
	null
,	null
,	null
,	null
,	adm_caty
,	null
,	null
,	null
,	null
,	null
,	bill_code
,	bill_no
, CASE  WHEN CHARINDEX( '^', biz_sn )> 0 THEN LEFT ( biz_sn, CHARINDEX( '^', biz_sn ) - 1 )  ELSE biz_sn  END AS biz_sn
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	chfpdr_code
,	null
,	chfpdr_name
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	dcla_time
,	null
,	null
,	dscg_caty
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	fixmedins_code
,	fixmedins_name
,	null
,	hi_no
,	hi_paymtd
,	hi_setl_lv
,	hi_type
,	hsorg
,	hsorg_code
,	hsorg_opter
,	hsorg_opter_code
,	insuplc
,	ipt_med_type
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
, CASE  WHEN CHARINDEX( '^', mdtrt_id )> 0 THEN LEFT ( mdtrt_id, CHARINDEX( '^', mdtrt_id ) - 1 )  ELSE mdtrt_id  END AS mdtrt_id
,	medcasno
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	medins_fill_dept
,	medins_fill_psn
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	opsp_diag_caty
,	opsp_mdtrt_date
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	psn_cashpay
,	psn_name
,	psn_no
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	setl_begn_date
,	setl_end_date
, CASE  WHEN CHARINDEX( '^', setl_id )> 0 THEN LEFT ( setl_id, CHARINDEX( '^', setl_id ) - 1 )  ELSE setl_id  END AS setl_id
,	null
,	sp_psn_type
,	null
,	null
,	null
,	null
,	null
,	null
,	null
,	null
, CASE  WHEN CHARINDEX( '^', mdtrt_id )> 0 THEN LEFT ( mdtrt_id, CHARINDEX( '^', mdtrt_id ) - 1 )  ELSE mdtrt_id  END AS mdtrt_sn
FROM
	t_setlinfo_mid 
where CASE  WHEN CHARINDEX( '^', mdtrt_id )> 0 THEN LEFT ( mdtrt_id, CHARINDEX( '^', mdtrt_id ) - 1 )  ELSE mdtrt_id end  not in (SELECT mdtrt_sn from t_setlinfo)